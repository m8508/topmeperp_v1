
@{
    ViewBag.Title = "工作任務分派";
    Layout = "~/Views/Shared/_MenuLayout.cshtml";
}

<div class="container">
    <input type="hidden" name="createid" id="createid" value="@ViewBag.createid" />
    <h3>工作分派</h3><br />
    <div class="row col-md-12">
        <label for="projectId">專案編號:</label>
        <input type="text" name="projectid" id="projectid" value="@ViewBag.projectid" />
    </div>
</div>
<h4>要進行任務分派時，請按"新增一列"按鈕來新增資料</h4><br />
<div class="container-fluid">
    <script type="text/javascript" src="../../Scripts/MicrosoftAjax.js"></script>
    <script type="text/javascript" src="../../Scripts/MicrosoftMvcAjax.js"></script>
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.5.1.min.js"></script>
    <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
    <div id="Template" style="display: none;">
        <div id="Task_${index}">
            <table border="1">
                <tr>
                    <td></td>
                    <td Align="Center">專案編號</td>
                    <td Align="Center">任務類型</td>
                    <td Align="Center">負責人員</td>
                    <td Align="Center">負責項目</td>
                    <td Align="Center">預定完成時間</td>
                    <td Align="Center">備註</td>
                    <td Align="Center">建立人</td>
                <tr>
                    <td><input type="hidden" name="TaskDatas.index" value="${index}" /></td>
                    <td width="50"><input type="text" name="TaskDatas[${index}].PROJECT_ID" value="@ViewBag.projectid" /></td>
                    <td width="100"><input type="text" name="TaskDatas[${index}].TASK_TYPE" /></td>
                    <td width="100"><input type="text" name="TaskDatas[${index}].USER_ID" /></td>
                    <td width="150"><input type="text" name="TaskDatas[${index}].TASK_ITEM" /></td>
                    <td width="100"><input type="text" name="TaskDatas[${index}].FINISH_DATE" id=""/></td>
                    <td width="150"><input type="text" name="TaskDatas[${index}].REMARK" /></td>
                    <td width="50"><input type="text" name="TaskDatas[${index}].CREATE_ID" value="@ViewBag.createid" /></td>
                    <td><input type="button" class="btn btn-info" value="刪除" onclick="Remove('${index}');" /></td>
            </table>
            <br />
        </div>
    </div>
    <div>
        @using (Ajax.BeginForm("Task", new AjaxOptions() { UpdateTargetId = "Result" }))
        {
            <input type="button" class="btn btn-primary" value="新增一列" onclick="Add();" />
            <input type="submit" class="btn btn-success" value="送出" /><br /><br />
            <div id="Task">
            </div>
        }
    </div>
</div>

<script type="text/javascript">
    // 將 DIV 內容先轉成 template
    var taskTemplate = $("#Template").template();

    function Add() {
        $.tmpl(taskTemplate, { index: new Date().getTime() }).appendTo("#Task");
    }

    function Remove(id) {
        $("#Task_" + id).remove();
    }
    $(document).ready(function () {
        $(function () {
            $("").datetimepicker({
                format: 'YYYY/MM/DD'
            });
        });
    })
</script>
<div class="container">
    @if (null != Model)
    {
        Html.RenderPartial("TaskDetails");
    }
</div>










